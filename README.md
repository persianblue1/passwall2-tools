markdown
# Passwall2 Routing & Backup Tools

ابزارهای خودکار برای تنظیم، آپدیت امن، بکاپ‌گیری و بازگردانی تنظیمات Passwall2 روی OpenWrt.

---

## 📦 محتویات مخزن

| فایل | توضیح |
|------|-------|
| `setup_passwall2_with_safe_updates_and_backup.sh` | تنظیم قوانین GeoIP/GeoSite/Regex برای ایران + آپدیت امن دیتابیس‌ها + بکاپ‌گیری روزانه |
| `restore_passwall2_backup.sh` | بازگردانی بکاپ با منوی انتخابی از آخرین نسخه‌های ذخیره‌شده |

---

## ⚙️ نصب و اجرا

### 1. اجرای اسکریپت تنظیم اولیه

```bash
sh setup_passwall2_with_safe_updates_and_backup.sh
این اسکریپت:

قوانین مسیریابی برای ایران را تنظیم می‌کند

دیتابیس‌های GeoIP و GeoSite را دانلود و نصب می‌کند

بکاپ‌گیری از تنظیمات را انجام می‌دهد

کران‌جاب روزانه برای آپدیت و بکاپ‌گیری اضافه می‌کند

مسیر بکاپ‌ها: /root/passwall2_backups/ مسیر دیتابیس‌ها: /usr/share/passwall2/

🔁 بازگردانی بکاپ
برای بازگردانی یکی از بکاپ‌های قبلی:

bash
sh restore_passwall2_backup.sh
سپس از شما خواسته می‌شود شمارهٔ بکاپ مورد نظر را انتخاب کنید. پس از انتخاب، تنظیمات و دیتابیس‌ها بازگردانی شده و سرویس Passwall2 ری‌استارت می‌شود.

🧠 نکات مهم
فقط ۱۰ بکاپ آخر نگه‌داری می‌شود؛ بکاپ‌های قدیمی‌تر به‌صورت خودکار حذف می‌شوند.

اگر دانلود GeoIP یا GeoSite ناموفق باشد، نسخهٔ قبلی حفظ می‌شود تا سرویس قطع نشود.

قوانین زیر برای ترافیک ایران به‌صورت مستقیم تنظیم می‌شوند:

IPهای ایران (GeoIP)

دامنه‌های ایرانی (GeoSite)

دامنه‌هایی با پسوند .ir (Regex)

📜 پیش‌نیازها
OpenWrt با نصب luci-app-passwall2

فعال بودن سرویس passwall2

دسترسی root برای اجرای اسکریپت‌ها

🧰 توسعه‌دهنده
GitHub: persianblue1

مخزن: passwall-routing-and-backup

📬 پیشنهاد یا مشکل؟
اگر پیشنهادی برای بهبود اسکریپت‌ها یا مشکلی در اجرا دارید، لطفاً در بخش Issues همین مخزن مطرح کنید.


---

اگر بخوای، همین فایل رو به‌صورت آماده برای commit در مخزنت آماده می‌کنم یا حتی نسخه انگلیسی هم برات می‌نویسم. فقط بگو چطور ادامه بدیم.
